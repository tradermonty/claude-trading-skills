# 再現手順の書き方ガイド（Reproduction Steps Guide）

## Overview

このガイドは、不具合の再現手順を明確かつ正確に記述するための方法を提供します。良い再現手順は、開発者が不具合を迅速に理解し、修正するために不可欠です。

## 再現手順の重要性

### なぜ再現手順が重要か？

1. **開発者が不具合を再現できる**: 見えない問題は修正できない
2. **修正の検証が可能**: 修正後に同じ手順で確認できる
3. **コミュニケーションコストの削減**: 追加の質問や確認が不要
4. **不具合の理解が深まる**: 手順を整理することで根本原因が見えることも

### 悪い再現手順の例

```
❌ 「ログインできない」
❌ 「エラーが出る」
❌ 「画面がおかしい」
❌ 「前は動いていたのに動かない」
❌ 「適当にクリックしたらバグった」
```

**問題点**:
- 具体的な操作が不明
- 条件が不明確
- 期待される結果と実際の結果が不明

---

## 再現手順の基本構成

### 必須要素（5W1H）

1. **事前条件（Preconditions）**: 開始前の状態
2. **再現手順（Steps to Reproduce）**: 具体的な操作手順
3. **期待される結果（Expected Result）**: 本来どうあるべきか
4. **実際の結果（Actual Result）**: 実際に何が起きたか
5. **環境情報（Environment）**: OS、ブラウザ、バージョン等

### テンプレート

```markdown
## 事前条件（Preconditions）
- [システムの状態、ログイン状態、テストデータ等]

## 再現手順（Steps to Reproduce）
1. [最初の操作]
2. [次の操作]
3. [さらなる操作]
...

## 期待される結果（Expected Result）
[本来どうあるべきか]

## 実際の結果（Actual Result）
[実際に何が起きたか]

## 環境情報（Environment）
- OS: [例: Windows 11, macOS Sonoma 14.1]
- ブラウザ: [例: Chrome 120.0.6099.109]
- 画面解像度: [例: 1920x1080]
- その他: [必要に応じて追加]
```

---

## 良い再現手順の原則（CLEAR原則）

### C - Complete（完全）
すべての必要な情報が含まれている

### L - Logical（論理的）
手順が論理的な順序で並んでいる

### E - Explicit（明示的）
曖昧な表現がなく、具体的

### A - Actionable（実行可能）
誰でも同じ手順を実行できる

### R - Reproducible（再現可能）
何度実行しても同じ結果になる

---

## 事前条件（Preconditions）の書き方

### 含めるべき情報

1. **ログイン状態**
   - ログインしているか、していないか
   - どのユーザー権限か（管理者、一般ユーザー等）

2. **データの状態**
   - 必要なテストデータ
   - データベースの状態
   - ファイルの準備

3. **システムの状態**
   - 特定の設定が必要か
   - キャッシュのクリアが必要か

### 良い例

```markdown
## 事前条件
- 一般ユーザー（user01@example.com / password123）でログイン済み
- テストデータ: 商品「テストプロダクトA」（ID: 12345）が在庫10個で登録済み
- ブラウザのキャッシュとCookieをクリア済み
- 画面: トップページ（https://example.com/）を表示
```

### 悪い例

```markdown
❌ ログインしている
❌ 適当なユーザーでログイン
❌ データがある状態
```

---

## 再現手順（Steps to Reproduce）の書き方

### 原則

1. **番号を付ける**: 順序を明確にする
2. **一つの手順に一つの操作**: 複数の操作を一つにまとめない
3. **具体的に記述**: 「適当に」「いい感じに」は禁止
4. **操作対象を明示**: どのボタン、どのフィールドかを明確に
5. **入力値を記載**: 実際に入力した値を書く

### 良い例

```markdown
## 再現手順
1. トップページ右上の「ログイン」ボタンをクリック
2. メールアドレス欄に「user@example.com」を入力
3. パスワード欄に「password123」を入力
4. 「ログイン」ボタンをクリック
5. 画面上部のナビゲーションから「商品管理」をクリック
6. 検索フィールドに「テスト」と入力
7. 虫眼鏡アイコンをクリック
8. 検索結果の1件目「テストプロダクトA」の「編集」ボタンをクリック
9. 「在庫数」フィールドを「10」から「5」に変更
10. ページ下部の「保存」ボタンをクリック
```

### 悪い例

```markdown
❌ 1. ログインする
❌ 2. 商品を探す
❌ 3. 編集する
❌ 4. 保存する

❌ 1. ログインして商品管理画面に行く
❌ 2. 適当に商品を編集して保存する
```

### 操作の記述例

| 操作 | 良い記述 | 悪い記述 |
|------|---------|---------|
| クリック | 「保存」ボタンをクリック | ボタンを押す、クリックする |
| 入力 | 「メールアドレス」欄に「user@example.com」を入力 | メール入力 |
| 選択 | ドロップダウンから「東京都」を選択 | 東京を選ぶ |
| チェック | 「利用規約に同意する」チェックボックスをチェック | チェックを入れる |
| ページ遷移 | URLバーに「https://example.com/admin」を直接入力してEnter | 管理画面に行く |

---

## 期待される結果（Expected Result）の書き方

### 原則

1. **具体的に記述**: 「正しく動作する」は不十分
2. **観測可能な状態を記述**: 何が見える、何が表示される
3. **仕様書やデザインを参照**: 可能な限り根拠を示す

### 良い例

```markdown
## 期待される結果
- 「保存が完了しました」という緑色の成功メッセージが画面上部に表示される
- 商品一覧ページ（https://example.com/products）にリダイレクトされる
- 商品一覧で「テストプロダクトA」の在庫数が「5」に更新されている
- データベースのproductsテーブルのstock列が5に更新されている
```

### 悪い例

```markdown
❌ 正しく保存される
❌ エラーが出ない
❌ 普通に動く
❌ 前のバージョンと同じ動作
```

---

## 実際の結果（Actual Result）の書き方

### 原則

1. **正確に記述**: 見たままを書く
2. **エラーメッセージは全文引用**: 一部省略しない
3. **スクリーンショットを添付**: 視覚的な証拠
4. **ログを添付**: 技術的な詳細が必要な場合

### 良い例

```markdown
## 実際の結果
- 「保存」ボタンをクリックすると、画面が一瞬フリーズする（約2秒）
- その後、赤色のエラーメッセージが表示される:
  「エラー: 在庫数の更新に失敗しました。(Error code: STOCK_UPDATE_FAILED_500)」
- ページはリダイレクトされず、編集画面のまま
- 商品一覧で確認すると、在庫数は「10」のまま変更されていない
- ブラウザのコンソールに以下のエラーが表示:
  ```
  POST https://example.com/api/products/12345 500 (Internal Server Error)
  ```
- スクリーンショット: [添付ファイル参照]
```

### 悪い例

```markdown
❌ エラーが出る
❌ 保存できない
❌ 何か変なメッセージが出た
❌ 画面がおかしくなる
```

---

## 環境情報（Environment）の書き方

### 必須情報

1. **OS**: Windows 11, macOS Sonoma 14.1, Ubuntu 22.04等
2. **ブラウザ**: Chrome 120.0.6099.109, Safari 17.1等
3. **画面解像度**: 1920x1080, 1366x768等
4. **デバイス**: iPhone 15 Pro, iPad Air, Dell XPS 13等

### 任意だが有用な情報

- **ネットワーク環境**: Wi-Fi, 4G, 社内LAN等
- **ブラウザの拡張機能**: 広告ブロッカー等
- **言語設定**: 日本語、英語等
- **タイムゾーン**: JST, UTC等
- **アプリバージョン**: v1.2.3等

### 良い例

```markdown
## 環境情報
- OS: Windows 11 Pro (22H2)
- ブラウザ: Google Chrome 120.0.6099.109 (64-bit)
- 画面解像度: 1920x1080
- ネットワーク: 社内Wi-Fi
- ブラウザ拡張: なし（シークレットモードで検証済み）
- 言語設定: 日本語
- タイムゾーン: Asia/Tokyo (JST)
```

### 悪い例

```markdown
❌ Windows
❌ 最新のChrome
❌ 普通のPC
```

---

## 実例: 良い不具合報告書

### 例1: ログイン失敗

```markdown
## 不具合タイトル
特定のメールアドレスでログインすると500エラーが発生する

## 事前条件
- ログアウト状態
- ブラウザのキャッシュとCookieをクリア済み
- テストユーザー: test+user@example.com（登録済み）

## 再現手順
1. トップページ（https://example.com/）にアクセス
2. 右上の「ログイン」ボタンをクリック
3. メールアドレス欄に「test+user@example.com」を入力
   （注: メールアドレスに「+」記号が含まれている）
4. パスワード欄に「Password123!」を入力
5. 「ログイン」ボタンをクリック

## 期待される結果
- ダッシュボード（https://example.com/dashboard）にリダイレクトされる
- 画面右上にユーザー名「Test User」が表示される
- セッションが確立され、ログイン状態になる

## 実際の結果
- ログインボタンをクリックすると、約3秒後に500エラーページが表示される
- エラーメッセージ: 「Internal Server Error - Something went wrong. Please try again later.」
- ログインは失敗し、ログアウト状態のまま
- サーバーログ（添付参照）に以下のエラーが記録されている:
  ```
  [ERROR] Invalid email format: test+user@example.com
  Caused by: java.util.regex.PatternSyntaxException: Illegal/unsupported escape sequence near index 4
  ```
- スクリーンショット: error_500.png

## 環境情報
- OS: Windows 11 Pro (22H2)
- ブラウザ: Google Chrome 120.0.6099.109 (64-bit)
- 画面解像度: 1920x1080
- ネットワーク: 社内Wi-Fi

## 補足情報
- 「+」記号を含まないメールアドレス（test@example.com）では正常にログイン可能
- RFC 5322ではメールアドレスのローカルパート（@より前）に「+」記号の使用が許可されている
- Gmail等で広く使われているエイリアス機能（test+tag@gmail.com）が使用できない問題
```

### 例2: UI表示崩れ

```markdown
## 不具合タイトル
スマートフォン（横向き）でナビゲーションメニューが画面外に表示される

## 事前条件
- 一般ユーザー（user@example.com）でログイン済み
- デバイス: iPhone 15 Pro
- 画面の向き: 横向き（ランドスケープモード）

## 再現手順
1. iPhone 15 Proでサイト（https://example.com/）にアクセス
2. ログイン画面で「user@example.com / Password123」でログイン
3. ダッシュボードが表示された状態で、iPhoneを横向きに回転
4. 画面左上のハンバーガーメニューアイコン（≡）をタップ

## 期待される結果
- 左側からスライドメニューが表示される
- メニュー項目（ホーム、プロフィール、設定、ログアウト）が全て表示される
- メニューの背景にオーバーレイが表示され、メニュー外をタップすると閉じる
- 参考: デザインモック「mobile_menu_landscape.fig」

## 実際の結果
- スライドメニューは表示されるが、メニューの高さが画面の高さを超えている
- 「ログアウト」ボタンが画面外に表示され、スクロールもできない
- メニューの一部が切れて表示される（添付スクリーンショット参照）
- オーバーレイは正常に表示される

## 環境情報
- デバイス: iPhone 15 Pro
- OS: iOS 17.2
- ブラウザ: Safari 17.2
- 画面解像度: 2556 x 1179（横向き時）
- 画面サイズ: 6.1インチ

## 補足情報
- 縦向き（ポートレートモード）では問題なく表示される
- 他のデバイス（iPhone 12, iPad Air）でも同様の問題を確認
- AndroidデバイスでもChrome、Firefoxで同様の問題を確認
- スクリーンショット: menu_landscape_issue.png
- 動画: menu_landscape_issue.mp4（添付）
```

---

## 再現頻度の記載

不具合の再現頻度も重要な情報です。

### 分類

- **100%（常に）**: 毎回必ず再現する
- **50-99%（頻繁）**: 高頻度で再現する
- **10-49%（時々）**: たまに再現する
- **1-9%（稀）**: 稀にしか再現しない
- **1回のみ**: 一度だけ発生、再現できない

### 記載例

```markdown
## 再現頻度
- 10回試行して10回とも再現（100%）
- 上記の手順で必ず再現可能

または

## 再現頻度
- 10回試行して3回再現（30%）
- 再現する条件が不明確だが、高頻度で発生
- タイミングやネットワーク状況に依存する可能性
```

---

## スクリーンショット・動画・ログの添付

### スクリーンショット

**いつ必要か**:
- UI/UXの問題
- エラーメッセージが表示される場合
- 視覚的に説明しやすい場合

**ベストプラクティス**:
- 画面全体をキャプチャ（URLバー含む）
- 問題箇所を赤枠や矢印で強調
- 複数の状態がある場合は、複数枚添付
- ファイル名を分かりやすく（例: error_message_login.png）

### 動画

**いつ必要か**:
- 操作の流れを見せる必要がある場合
- アニメーションやトランジションの問題
- 再現手順が複雑な場合

**ベストプラクティス**:
- 短く（30秒〜2分程度）
- 不要な操作は編集でカット
- 音声で説明を入れると◎

### ログ

**いつ必要か**:
- バックエンドエラー
- ネットワークエラー
- パフォーマンス問題

**含めるべきログ**:
- ブラウザのコンソールログ
- ネットワークタブ（API呼び出し）
- サーバーログ（可能な場合）
- モバイルアプリのクラッシュログ

---

## チェックリスト

再現手順を書く前に、このチェックリストを確認してください。

### 事前確認
- [ ] 本当に不具合か？（仕様通りではないか）
- [ ] 最新版で確認したか？
- [ ] 環境を変えても再現するか？
- [ ] キャッシュをクリアしたか？
- [ ] ブラウザの拡張機能を無効にしたか？

### 記載内容
- [ ] 事前条件が明記されているか？
- [ ] 再現手順が具体的か？
- [ ] 一つの手順に一つの操作か？
- [ ] 入力値が明記されているか？
- [ ] 期待される結果が明確か？
- [ ] 実際の結果が正確に記述されているか？
- [ ] 環境情報が記載されているか？
- [ ] 再現頻度が記載されているか？
- [ ] 必要なスクリーンショット・ログが添付されているか？

### 第三者レビュー
- [ ] 他の人が読んでも再現できるか？
- [ ] 曖昧な表現はないか？
- [ ] 専門用語が適切に使われているか？

---

## よくある間違いと改善例

### 間違い1: 手順が抽象的

❌ **悪い例**:
```
1. ログインする
2. 商品を検索する
3. エラーが出る
```

✅ **良い例**:
```
1. トップページ右上の「ログイン」ボタンをクリック
2. メールアドレス欄に「user@example.com」、パスワード欄に「Password123」を入力し、「ログイン」ボタンをクリック
3. ダッシュボードのヘッダーにある検索フィールドに「テスト商品」と入力
4. 虫眼鏡アイコンをクリック
5. 500エラーページが表示される
```

### 間違い2: 期待値と実際の結果が曖昧

❌ **悪い例**:
```
期待される結果: 正常に動作する
実際の結果: エラーが出る
```

✅ **良い例**:
```
期待される結果:
- 検索結果一覧ページが表示される
- 「テスト商品」を含む商品が一覧表示される
- 検索結果件数が表示される（例: 「5件の商品が見つかりました」）

実際の結果:
- 500 Internal Server Errorページが表示される
- エラーメッセージ: 「検索処理中にエラーが発生しました。しばらくしてから再度お試しください。」
- ブラウザコンソールに以下のエラー:
  ```
  GET https://example.com/api/search?q=テスト商品 500 (Internal Server Error)
  ```
```

### 間違い3: 環境情報が不足

❌ **悪い例**:
```
Windows、Chrome
```

✅ **良い例**:
```
- OS: Windows 11 Pro (22H2, Build 22621.2715)
- ブラウザ: Google Chrome 120.0.6099.109 (64-bit)
- 画面解像度: 1920x1080
- ネットワーク: 社内有線LAN
- ブラウザ拡張機能: なし（検証済み）
```

---

このガイドを使用して、開発者が不具合を迅速に理解し修正できる、明確で具体的な再現手順を作成しましょう。
