# 不具合分類ガイド（Defect Classification Guide）

## Overview

このガイドは、システム開発のテストで発見された不具合を適切に分類し、効果的に報告するための基準を提供します。

## 不具合のタイプ分類（Defect Type Classification）

### 1. 機能不具合（Functional Defect）

**定義**: システムの機能が仕様通りに動作しない

**サブカテゴリ**:
- **機能欠如（Missing Function）**: 必要な機能が実装されていない
- **機能誤動作（Incorrect Function）**: 機能は存在するが、期待通りに動作しない
- **余分な機能（Unwanted Function）**: 仕様にない機能が実装されている

**例**:
```
【機能欠如】
- ログイン画面に「パスワードを忘れた」リンクがない
- 検索結果の並び替え機能が実装されていない

【機能誤動作】
- 小数点を含む金額を入力すると計算結果が誤る
- ファイルアップロード時に拡張子チェックが機能しない

【余分な機能】
- 一般ユーザーに管理者機能が表示される
```

### 2. UI/UX不具合（UI/UX Defect）

**定義**: ユーザーインターフェースやユーザー体験の問題

**サブカテゴリ**:
- **表示崩れ（Layout Issue）**: レイアウトが崩れる、要素が重なる
- **デザイン不一致（Design Inconsistency）**: デザインガイドラインと異なる
- **操作性問題（Usability Issue）**: 操作が分かりにくい、使いにくい
- **アクセシビリティ問題（Accessibility Issue）**: キーボード操作不可、スクリーンリーダー非対応

**例**:
```
【表示崩れ】
- スマートフォンで表示するとボタンが画面外に出る
- 長いテキストを入力すると入力欄からはみ出る

【デザイン不一致】
- ボタンの色がデザインガイドラインと異なる
- フォントサイズが統一されていない

【操作性問題】
- エラーメッセージが分かりにくい
- 必須項目が明示されていない
- 保存ボタンの位置が分かりにくい

【アクセシビリティ問題】
- Tabキーでフォーカス移動できない
- 画像にalt属性がない
```

### 3. パフォーマンス不具合（Performance Defect）

**定義**: システムの性能が要件を満たさない

**サブカテゴリ**:
- **応答速度問題（Response Time）**: 処理が遅い、タイムアウトする
- **リソース消費問題（Resource Usage）**: メモリ、CPU使用率が高い
- **スケーラビリティ問題（Scalability）**: 同時接続数が増えるとパフォーマンス劣化

**例**:
```
【応答速度問題】
- 検索処理に10秒以上かかる（要件: 3秒以内）
- ファイルダウンロードが途中で止まる

【リソース消費問題】
- アプリ起動後、メモリ使用量が増加し続ける（メモリリーク）
- バックグラウンド処理中にCPU使用率が100%になる

【スケーラビリティ問題】
- 100ユーザー同時接続で応答時間が10倍に増加
```

### 4. データ不具合（Data Defect）

**定義**: データの整合性、正確性、保存に関する問題

**サブカテゴリ**:
- **データ損失（Data Loss）**: データが保存されない、消える
- **データ不整合（Data Inconsistency）**: データ間の整合性が取れていない
- **データ破損（Data Corruption）**: データが壊れる

**例**:
```
【データ損失】
- フォームを送信したが、データベースに保存されていない
- 編集内容が保存されずに元に戻る

【データ不整合】
- 在庫数と販売数の合計が合わない
- ユーザーテーブルと注文テーブルの顧客IDが一致しない

【データ破損】
- CSVエクスポート時に文字化けが発生
- 画像ファイルアップロード後、画像が壊れている
```

### 5. セキュリティ不具合（Security Defect）

**定義**: セキュリティ上の脆弱性や問題

**サブカテゴリ**:
- **認証・認可問題（Authentication/Authorization）**: 不正アクセス可能
- **データ漏洩（Data Exposure）**: 機密情報が漏洩する
- **インジェクション（Injection）**: SQLインジェクション、XSS等
- **セッション管理問題（Session Management）**: セッション乗っ取り可能

**例**:
```
【認証・認可問題】
- URLを直接入力すると認証なしでアクセスできる
- 他のユーザーのデータを閲覧・編集できる

【データ漏洩】
- エラーメッセージにパスワードが表示される
- APIレスポンスに他ユーザーの個人情報が含まれる

【インジェクション】
- 検索欄に「' OR 1=1--」を入力すると全データが表示される（SQLインジェクション）
- コメント欄にスクリプトタグを入力すると実行される（XSS）

【セッション管理問題】
- ログアウト後もセッションが有効なまま
- セッションIDがURLに含まれている
```

### 6. 統合・連携不具合（Integration Defect）

**定義**: 外部システムやサービスとの連携の問題

**サブカテゴリ**:
- **API連携エラー（API Integration Error）**: 外部APIとの通信失敗
- **データ連携エラー（Data Integration Error）**: データ同期の失敗
- **認証連携エラー（SSO/OAuth Error）**: シングルサインオンの失敗

**例**:
```
【API連携エラー】
- 決済APIを呼び出すと500エラーが返る
- 天気情報APIのレスポンスをパースできない

【データ連携エラー】
- CRMシステムとの顧客データ同期が失敗する
- 在庫システムとの連携で数量が正しく反映されない

【認証連携エラー】
- Google SSOでログインすると権限が正しく設定されない
- SAML認証のリダイレクトが無限ループになる
```

### 7. 環境依存不具合（Environment-Specific Defect）

**定義**: 特定の環境でのみ発生する問題

**サブカテゴリ**:
- **ブラウザ依存（Browser-Specific）**: 特定ブラウザでのみ発生
- **OS依存（OS-Specific）**: 特定OSでのみ発生
- **デバイス依存（Device-Specific）**: 特定デバイスでのみ発生
- **環境設定依存（Configuration-Specific）**: 特定の設定でのみ発生

**例**:
```
【ブラウザ依存】
- Safariでのみ日付ピッカーが機能しない
- Internet Explorer 11でレイアウトが崩れる

【OS依存】
- Windows環境でのみファイルパスにバックスラッシュが使われエラーになる
- macOSでのみショートカットキーが機能しない

【デバイス依存】
- iPhone SEでのみボタンが押せない
- 特定Androidデバイスでのみクラッシュする

【環境設定依存】
- タイムゾーンが日本以外の場合、日時表示がおかしい
- ロケール設定が英語の場合、数値フォーマットが崩れる
```

---

## 不具合の発生フェーズ分類（Defect Phase Classification）

### 要件定義フェーズ（Requirements Phase）
- 要件漏れ、要件誤り、要件曖昧

### 設計フェーズ（Design Phase）
- アーキテクチャ設計ミス、UI/UX設計ミス、データベース設計ミス

### 実装フェーズ（Implementation Phase）
- コーディングミス、ロジックエラー、タイプミス

### テストフェーズ（Testing Phase）
- テストデータ不備、環境構築ミス

### デプロイフェーズ（Deployment Phase）
- 設定ミス、環境差分、マイグレーション失敗

---

## 不具合の原因分類（Root Cause Classification）

### 1. 仕様理解不足（Specification Misunderstanding）
開発者が要件や仕様を誤解している

### 2. 設計ミス（Design Flaw）
システム設計やアーキテクチャに問題がある

### 3. コーディングエラー（Coding Error）
- タイプミス
- ロジックエラー
- 例外処理漏れ
- エッジケース未対応

### 4. 環境問題（Environment Issue）
- 開発環境とテスト環境の差分
- 依存ライブラリのバージョン違い
- 設定ファイルの誤り

### 5. データ問題（Data Issue）
- テストデータ不備
- マスタデータ不整合
- データ移行ミス

### 6. 第三者システム問題（Third-Party Issue）
- 外部APIの仕様変更
- ライブラリのバグ
- インフラストラクチャの問題

---

## 不具合の影響範囲分類（Impact Scope Classification）

### 全体影響（System-Wide Impact）
システム全体が使用不可、全ユーザーに影響

### 機能影響（Feature-Level Impact）
特定の機能が使用不可、一部のユーザーに影響

### 局所影響（Localized Impact）
限定的な条件下でのみ発生、少数のユーザーに影響

### 視覚的影響（Cosmetic Impact）
見た目の問題のみ、機能には影響なし

---

## 不具合報告時の分類選択ガイド

### ステップ1: タイプを特定
「何が問題か」を考える
- 機能が動かない → 機能不具合
- 見た目がおかしい → UI/UX不具合
- 遅い → パフォーマンス不具合
- データがおかしい → データ不具合
- セキュリティ懸念 → セキュリティ不具合
- 外部連携の問題 → 統合・連携不具合
- 特定環境のみ → 環境依存不具合

### ステップ2: サブカテゴリを選択
より具体的な問題の種類を特定

### ステップ3: 影響範囲を評価
どの範囲に影響があるかを判断

### ステップ4: 重要度・優先度を判定
`severity_priority_guide.md`を参照して判定

---

## 分類例

### 例1: ログイン失敗

```yaml
タイプ: 機能不具合（Functional Defect）
サブカテゴリ: 機能誤動作（Incorrect Function）
発生フェーズ: 実装フェーズ
原因（推定）: コーディングエラー
影響範囲: 全体影響
```

### 例2: スマホで表示崩れ

```yaml
タイプ: UI/UX不具合（UI/UX Defect）
サブカテゴリ: 表示崩れ（Layout Issue）
発生フェーズ: 設計フェーズ
原因（推定）: レスポンシブデザイン設計ミス
影響範囲: デバイス影響（スマートフォンユーザー）
```

### 例3: SQLインジェクション脆弱性

```yaml
タイプ: セキュリティ不具合（Security Defect）
サブカテゴリ: インジェクション（Injection）
発生フェーズ: 実装フェーズ
原因（推定）: 入力値検証不足、パラメータ化クエリ未使用
影響範囲: 全体影響（重大なセキュリティリスク）
```

---

## ベストプラクティス

1. **明確な分類**: 不具合を正しく分類することで、優先順位付けと対応が迅速になる
2. **具体的な記述**: 抽象的な分類ではなく、具体的なサブカテゴリまで選択する
3. **複数タイプの場合**: 主要な問題を優先し、補足として他のタイプも記載
4. **不明な場合**: 分類が不明な場合は「詳細調査が必要」と記載し、開発チームに判断を委ねる

---

このガイドを使用して、不具合を体系的に分類し、開発チームが効率的に対応できるようにしましょう。
